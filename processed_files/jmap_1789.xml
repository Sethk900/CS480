Microhabitat heterogeneity influences offspring sex allocation and spatial kin structure in possums.<ol><li>Sex allocation theory predicts that where dispersal is sex biased, the fitness consequences of producing male or female offspring are mediated by resource availability and maternal competitive ability. Females in poorer condition are expected to favour dispersing offspring to minimize resource competition with kin. Environmental heterogeneity may drive spatial variation in sex allocation through resource competition-related benefits to females and territory quality benefits to dispersing or philopatric offspring.</li><li>Here, we demonstrate that microhabitat heterogeneity can drive extremely fine-scale spatial heterogeneity in offspring sex allocation. Female bobucks (<em>Trichosurus cunninghami</em>) in temperate rainforest were more likely to produce male offspring than those in surrounding <em>Eucalyptus</em> forest.</li><li>A maternal physiological effect was identified, in that females of lower body mass were more likely to produce male offspring. This finding is consistent with resource competition predictions, in that smaller females are expected to have poorer competitive ability.</li><li>Genetic spatial autocorrelation analysis identified males as the more dispersing sex. Furthermore, overproduction of males by mothers in the rainforest habitat was geographically concordant with reduced philopatry, as inferred from spatial genetic analysis. This provides empirical validation of dispersal-related explanations of offspring sex allocation: that production of offspring of the dispersing sex minimizes the potential for resource competition with kin.</li><li>Spatial variation in dispersal via sex allocation responses to environmental heterogeneity can potentially contribute to spatial patterns in population dynamics.</li></ol>